
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Refactor - The Blog from Darel</title>
  <meta name="author" content="Darel Finkbeiner">

  
  <meta name="description" content="You&rsquo;ve heard of refactoring. Wikipedia has a pretty good definition.
You have probably done it. You may not have even known it. I often think &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://darelf.github.io/blog/2014/02/06/refactor">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The Blog from Darel" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48691206-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The Blog from Darel</a></h1>
  
    <h2>A blog about stuff... and things</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:darelf.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://darelf.github.io/blog/2014/02/06/refactor/" data-via="darelf" data-counturl="http://darelf.github.io/blog/2014/02/06/refactor/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
  
  <header>
    
      <h1 class="entry-title">Refactor</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-06T09:40:06-05:00" pubdate data-updated="true">Feb 6<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>You&rsquo;ve heard of refactoring. Wikipedia has a pretty good <a href="http://en.wikipedia.org/wiki/Code_refactoring">definition</a>.
You have probably done it. You may not have even known it.</p>

<p>I often think of refactoring as the primary job in programming. It cuts to the heart of
what this is all about, and the philosophy of programming in general. Refactoring code well
means being disciplined about code structure in the first place. It is the anti-spaghetti code.
It is the way in which we accomplish those ideals of &ldquo;elegant&rdquo; code.</p>

<!--more-->


<p>So, I thought I would give a recent example of something I worked on. It&rsquo;s a small bit. Which
is the best kind, and goes to the point of the whole thing. The rule I live by is to reduce
the problem into smaller and smaller pieces until it is actually manageable.</p>

<p>My problem was filtering.</p>

<p>Specifically, filtering a list of javascript objects by some items in the keys. Easy one that.
Then, one of the filters needed to check for the existance of some key on some other list of
objects.</p>

<p>In the first pass of this, the filter function was written specifically to the problem we
were trying to solve. Here&rsquo;s an example (although the objects were more complex than this):</p>

<pre><code>var array_1 = [{name: 'Joe'}, {name: 'Jane'}]

var array_2 = [{id: 1, name: 'Jane'}, {id:2, name: 'Jane'}]
</code></pre>

<p>So, the idea is to filter the first array to only include objects whose <code>name</code> attribute is
found in the second array. That is, if we run the filter on this sample, it should return this array:
<code>[{name: 'Jane'}]</code></p>

<p>Again, the first pass of this looked like this:</p>

<pre><code>var new_array = array_1.filter(function(v,i,a) {
    for (i = 0; i &lt; array_2.length; i++) {
        if (array_2[i]['name'] == v['name']) return true
    }
    return false
})
</code></pre>

<p>This is very specific. The name of the key, the fact that <code>array_2</code> needs to be in scope, these
all have to be true when running this. More importantly, such a function that looks for a
match in an array could be very useful in more than one context. It&rsquo;s an obvious (some
would say blindingly so) candidate for refactoring.</p>

<p>Without much ado, here&rsquo;s the refactored version of this that I can now use in other places
where I need similar functionality:</p>

<pre><code>function contains(a, key, value) {
    for (i = 0; i &lt; a.length; i++) {
        if (a[i][key] == value) return true
    }
    return false
}
</code></pre>

<p>Much better! Now I can call this function in order to determine if an array of objects
contains a value on a given key. It&rsquo;s not perfect. And it&rsquo;s specific to an array of
objects, and won&rsquo;t work on flat arrays. It could be made even better or more generic,
though we begin at that point to enter the territory of trade-off value.</p>

<p>This version makes a lot of sense in the context of the application, as that application
uses quite a lot of arrays of objects.</p>

<p>It may seem like a small thing, and it is, but these kind of tiny little refactorings
over the course of an entire application will make the code better, more readable,
and more maintainable. ( The name <code>contains</code> is easy to read and understand what
it&rsquo;s supposed to do )</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Darel Finkbeiner</span></span>

      








  


<time datetime="2014-02-06T09:40:06-05:00" pubdate data-updated="true">Feb 6<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/programming/'>programming</a>, <a class='category' href='/blog/categories/tips/'>tips</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://darelf.github.io/blog/2014/02/06/refactor/" data-via="darelf" data-counturl="http://darelf.github.io/blog/2014/02/06/refactor/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/02/04/programmer-identification/" title="Previous Post: Programmer Identification">&laquo; Programmer Identification</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/02/07/semver/" title="Next Post: Semver">Semver &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/04/02/simple-programming/">Simple Programming</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/24/lazarus-the-not-dead/">Lazarus - the Not Dead</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/24/exposition/">Exposition</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/18/data-synchonization/">Data Synchonization</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/11/distributed-jobs/">Distributed Jobs</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/blog/'>blog <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/browserify/'>browserify <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/complexity/'>complexity <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/creative/'>creative <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/culture/'>culture <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/data/'>data <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/http/'>http <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/lazarus/'>lazarus <span class='badge'>4</span></a></li>
<li class='category'><a href='/blog/categories/modules/'>modules <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/network/'>network <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/node/'>node <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/nodejs/'>nodejs <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/pathfinder/'>pathfinder <span class='badge'>5</span></a></li>
<li class='category'><a href='/blog/categories/philosophy/'>philosophy <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/programming/'>programming <span class='badge'>9</span></a></li>
<li class='category'><a href='/blog/categories/queue/'>queue <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/rpg/'>rpg <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/storytelling/'>storytelling <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/streams/'>streams <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/sync/'>sync <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/synchronization/'>synchronization <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/tips/'>tips <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/versioning/'>versioning <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/war/'>war <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/websockets/'>websockets <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/writing/'>writing <span class='badge'>1</span></a></li>

  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Darel Finkbeiner -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
