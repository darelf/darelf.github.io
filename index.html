
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The Blog from Darel</title>
  <meta name="author" content="Darel Finkbeiner">

  
  <meta name="description" content="So I have to keep track of what I work on each week and send
out an email with a short description of each. Yeah. You know. I thought &ldquo;What a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://darelf.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The Blog from Darel" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-48691206-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The Blog from Darel</a></h1>
  
    <h2>A blog about stuff... and things</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:darelf.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/22/using-npm-like-a-boss/">Using NPM Like a Boss</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-22T13:50:43-04:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I have to keep track of what I work on each week and send
out an email with a short description of each. Yeah. You know.</p>

<p>I thought &ldquo;What a great idea for making a script that handles all
that with a simple command line!&rdquo; I hear you mumbling &ldquo;nerd&rdquo;. That&rsquo;s
OK. I can take it.</p>

<h2>Enter&hellip; The Script</h2>

<p>Well, I just need a list, each list can live in a text file that I
can then email to my boss each week. What do I need?</p>

<p>Very little. I use <a href="http://momentjs.org">moment</a> to figure out what
week I&rsquo;m working on automatically and store it in the correct file.
I also use <a href="http://github.com/substack/minimist">minimist</a> to do
command line parsing since I barely need anything there.</p>

<p>So the beginning looked like this:</p>

<pre><code>var fs = require('fs')
var moment = require('moment')
</code></pre>

<p>Then I realized I (or someone) might want it daily, so I add a
default. And while I&rsquo;m at it, let&rsquo;s define a working directory
for the files.</p>

<pre><code>var defaults = { weekly: true, workdir: process.env.HOME + '/worklist/' }
var argv = require('minimist')(process.argv.slice(2), {default: defaults})
</code></pre>

<p>You could override those, for instance with <code>--workdir=/my/crazy/directory/</code> but
hopefully these are sane defaults.</p>

<p>Now let&rsquo;s figure out what file we should be working with:</p>

<pre><code>var m = moment()
if (argv.weekly) {
  m = moment().startOf('week').add('days', 1)
}

var fname = argv.workdir + m.format('YYYY-MM-DD') + '.txt'
</code></pre>

<p>The file name will now have the date, or Monday&rsquo;s date when we are doing weekly
files. This let&rsquo;s us choose.</p>

<p>Next we read in the file, if it exists, and parse the contents:</p>

<pre><code>var contents = []
fs.readFile(fname, function(err, data) {
  if (!err) {
    contents = data.toString().split('\n').filter(Boolean)
    parseCommands()
  }
})
</code></pre>

<p>That <code>parseCommands()</code> function will need to be defined. It&rsquo;s basically the
entry point for looking at any command the user sent and taking the correct
action. I decided I only needed 3 commands:  list, add, and delete.</p>

<pre><code>function parseCommands() {
  if (argv._.indexOf('list') &gt; -1) {
    contents.forEach(function(v,i) { console.log("%d: %s", i, v) })
  }
  if (argv.add) {
    contents.push(argv.add)
    saveContents()
  }
  if (argv.d) {
    if (contents.length &gt; argv.d) {
      delete contents[argv.d]
      saveContents()
    }
  }
}
</code></pre>

<p>What have going on here is a <code>list</code> command that just dumps the contents.
Next, we have a <code>--add="This is the item to add"</code> command that will add
a single line to our file, and then it will save the file. (see below for that)
And finally the <code>-d #</code> command that takes the number of the item to delete.</p>

<p>Not really pretty, but since I&rsquo;m mostly just adding and listing, it seems
to work just fine. And since the files are just text files, I can always
edit them by hand, feed them into other programs or utilities easily, and
generally use any of my typical Unixy workflows.</p>

<p>Oh, and saving the file just looks like this:</p>

<pre><code>function saveContents() {
  fs.writeFile(fname, contents.join('\n') + '\n')
}
</code></pre>

<h2>Enter&hellip; NPM!!!</h2>

<p>How does the <code>npm</code> utility enter in to this? I&rsquo;m glad you asked!</p>

<p>NPM has a facility called &ldquo;bin&rdquo; in the <code>package.json</code> file that allows you
to define so-called <code>binary</code> programs to be installed. In my case, this is
just a node js script as shown above.</p>

<p>What steps do I take to make this work as a command? I.e. <code>worklist list</code> or
<code>worklist --add="I totally did important work just now"</code></p>

<h3>Step One</h3>

<p>Add the &ldquo;shebang&rdquo; at the beginning of the script telling it to use node.</p>

<pre><code>#!/usr/bin/env node
</code></pre>

<p>For the script, that&rsquo;s it.</p>

<h3>Step Two</h3>

<p>Add the entry into <code>package.json</code> telling it that the script is a binary.
For our example, I put the script in <code>./bin/worklist.js</code> so that&rsquo;s what I
will tell NPM. Also, I need to tell it what I want the command to look like,
which in this example is <code>worklist</code> so that I can just type <code>worklist</code> on the
command line and it will run my script in node automatically.</p>

<pre><code>{
  ... bunch of normal package.json stuff ...
  "bin": {
    "worklist": "./bin/worklist.js"
  }
}
</code></pre>

<h3>Step Three</h3>

<p>Install it globally.</p>

<pre><code>npm install -g
</code></pre>

<p>You will notice NPM telling you that it is linking the script into your path
somewhere. I believe on Windows that this also automatically wraps it in a
<code>.cmd</code> for you. WIN.</p>

<h3>Step Four</h3>

<p>Pour a hot cup of coffee, light up your favorite cigar, and enjoy. THIS STEP
IS NOT OPTIONAL.</p>

<h2>Feedback</h2>

<p>Please, please, please, send me feedback, ask me questions. Yeah. You can do it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/14/lazarus-yo-ho/">Lazarus - Yo Ho</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-14T12:32:30-04:00" pubdate data-updated="true">Apr 14<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Life no longer gives me lemons. Not after what happened the last time.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/04/14/lazarus-yo-ho/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/09/evented/">Evented</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-09T13:06:49-04:00" pubdate data-updated="true">Apr 9<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the big advantages of <a href="http://nodejs.org">node.js</a> is that of events and
an emphasis on asynchronous programming.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/04/09/evented/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/07/lazarus-tactics/">Lazarus - Tactics</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-07T09:01:00-04:00" pubdate data-updated="true">Apr 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There&rsquo;s some sort of northern barbarian that hangs out in Mae&rsquo;s group. Odd fellow.
Keeps to himself mostly. At first I thought he didn&rsquo;t speak the language, until
he went into a semi-furious rant about some vision he had.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/04/07/lazarus-tactics/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/02/simple-programming/">Simple Programming</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-02T08:19:57-04:00" pubdate data-updated="true">Apr 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&ldquo;All that is complex is not useful. All that is useful is simple.&rdquo; &mdash; Mikhail Kalashnikov</p>

<p>&ldquo;A scientific theory should be as simple as possible, but no simpler.&rdquo; &mdash; Albert Einstein</p>

<p>Ran into this problem recently. It&rsquo;s very difficult to deal with programmers sometimes,
as they tend to very often be right in the face of naysayers, they get used to it and
just assume that their way is right even when it&rsquo;s obviously wrong.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/04/02/simple-programming/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/24/lazarus-the-not-dead/">Lazarus - the Not Dead</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-24T10:56:55-04:00" pubdate data-updated="true">Mar 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Having gotten themselves banned from the city, the adventuring group led by Mae approached the
walls with not a little trepidation. Unfortunately, the Red Mantis had a use for the group and
offered to clear their names in exchange for some help. This was obviously not going to play to
my advantage. The Mantis are constantly interfering, the meddlesome brats.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/24/lazarus-the-not-dead/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/24/exposition/">Exposition</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-24T09:29:28-04:00" pubdate data-updated="true">Mar 24<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There&rsquo;s a very well known saying in writing: &ldquo;Show, Don&rsquo;t Tell&rdquo;. I&rsquo;m sure you&rsquo;ve heard
it, either in some class or in a book on creative writing. The other famous saying comes
from screenwriting, &ldquo;Exposition = Death&rdquo;, meaning it sucks all the drama out of a scene
and bores your viewers.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/24/exposition/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/18/data-synchonization/">Data Synchonization</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-18T09:40:31-04:00" pubdate data-updated="true">Mar 18<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Data. Always getting out of sync. You&rsquo;d think it would learn. You&rsquo;d think that
maybe if you tightened up your code it would never get out of sync.</p>

<p>Well. Data don&rsquo;t care what you think. That&rsquo;s why CRC, etc.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/18/data-synchonization/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/11/distributed-jobs/">Distributed Jobs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-11T13:12:33-04:00" pubdate data-updated="true">Mar 11<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post is supposed to be about network queuing of jobs that can be
distributed into discrete tasks which themselves can be completed in
any order. And about the boiled down <a href="http://github.com/darelf/stream-queue">stream-queue</a>
npm package that I have published. I will diverge just a bit here to
talk a little bit of background.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/11/distributed-jobs/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/10/lazarus-business/">Lazarus - Business</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T08:06:49-04:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There tends to be, in my experience, a certain bonding moment that
happens among a give group of adventurers. And it usually has to do with loot.
Whether gold or precious gems or magic swords.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/03/10/lazarus-business/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/04/22/using-npm-like-a-boss/">Using NPM Like a Boss</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/14/lazarus-yo-ho/">Lazarus - Yo Ho</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/09/evented/">Evented</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/07/lazarus-tactics/">Lazarus - Tactics</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/02/simple-programming/">Simple Programming</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/i-o/'>I/O <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/asynchronous/'>asynchronous <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/blog/'>blog <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/browserify/'>browserify <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/complexity/'>complexity <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/creative/'>creative <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/culture/'>culture <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/data/'>data <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/events/'>events <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/http/'>http <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/lazarus/'>lazarus <span class='badge'>6</span></a></li>
<li class='category'><a href='/blog/categories/modules/'>modules <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/network/'>network <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/node/'>node <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/nodejs/'>nodejs <span class='badge'>4</span></a></li>
<li class='category'><a href='/blog/categories/npm/'>npm <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/pathfinder/'>pathfinder <span class='badge'>7</span></a></li>
<li class='category'><a href='/blog/categories/philosophy/'>philosophy <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/pirates/'>pirates <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/programming/'>programming <span class='badge'>11</span></a></li>
<li class='category'><a href='/blog/categories/queue/'>queue <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/rpg/'>rpg <span class='badge'>2</span></a></li>
<li class='category'><a href='/blog/categories/storytelling/'>storytelling <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/streams/'>streams <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/sync/'>sync <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/synchronization/'>synchronization <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/tips/'>tips <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/versioning/'>versioning <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/war/'>war <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/websockets/'>websockets <span class='badge'>1</span></a></li>
<li class='category'><a href='/blog/categories/writing/'>writing <span class='badge'>1</span></a></li>

  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Darel Finkbeiner -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
